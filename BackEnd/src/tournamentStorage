// TODO need to talk to bruno to see if this makes sense 

const tournaments = new Map(); // tournamentId -> tournament data

function saveTournament(tournamentId, tournamentData) {
	tournaments.set(tournamentId, {
		...tournamentData,
	});
	console.log(`📝 Tournament ${tournamentId} saved`);
}

function getTournament(tournamentId) {
	return tournaments.get(tournamentId);
}

function updateTournamentWinner(tournamentId, matchIndex, winner) {
	const tournament = tournaments.get(tournamentId);
	if (!tournament)
		return false;

	if (matchIndex === 0) {
		tournament.semifinal1Winner = winner;
	} else if (matchIndex === 1) {
		tournament.semifinal2Winner = winner;
	} else if (matchIndex === 2) {
		tournament.finalWinner = winner;
		tournament.isCompleted = true;
	}

	tournament.currentMatchIndex = Math.max(tournament.currentMatchIndex, matchIndex + 1);
	
	console.log(`🏆 Tournament ${tournamentId} updated: Match ${matchIndex} winner = ${winner}`);
	return true;
}

module.exports = {
	tournaments,
	saveTournament,
	getTournament,
	updateTournamentWinner
};